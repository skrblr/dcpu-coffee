// Generated by CoffeeScript 1.3.1
(function() {
  var Disasm, Module, dcpu;

  Module = {};

  dcpu = require('./dcpu');

  Disasm = (function() {

    Disasm.name = 'Disasm';

    function Disasm() {}

    Disasm.OPC_DISASM = ["ADV", "SET", "ADD", "SUB", "MUL", "DIV", "MOD", "SHL", "SHR", "AND", "BOR", "XOR", "IFE", "IFN", "IFG", "IFB"];

    Disasm.ADV_OPC_DISASM = ["RSV", "JSR"];

    Disasm.REG_DISASM = ["A", "B", "C", "X", "Y", "Z", "I", "J", "PC", "SP", "O"];

    Disasm.fmtHex = function(n, pad) {
      var p, str, _, _i, _ref;
      if (pad == null) {
        pad = true;
      }
      str = n.toString(16);
      p = "";
      if (pad) {
        for (_ = _i = 0, _ref = 4 - str.length; 0 <= _ref ? _i <= _ref : _i >= _ref; _ = 0 <= _ref ? ++_i : --_i) {
          p = p + "0";
        }
      }
      return p.slice(1) + str;
    };

    Disasm.ppInstr = function(instr) {
      var op, va, vb;
      if (instr.mOpc === 0) {
        op = Disasm.ADV_OPC_DISASM[instr.mValA.raw()];
        va = Disasm.ppValue(instr.mValB);
        return "" + op + " " + va;
      } else {
        op = Disasm.OPC_DISASM[instr.mOpc];
        va = Disasm.ppValue(instr.mValA);
        vb = Disasm.ppValue(instr.mValB);
        return "" + op + " " + va + ", " + vb;
      }
    };

    Disasm.ppValue = function(val) {
      var enc, lit, reg, v;
      enc = val.raw();
      v = "";
      if ((0x00 <= enc && enc <= 0x07)) {
        return v = Disasm.REG_DISASM[enc];
      } else if ((0x08 <= enc && enc <= 0x0f)) {
        reg = Disasm.REG_DISASM[enc - 0x8];
        return v = "[" + reg + "]";
      } else if ((0x10 <= enc && enc <= 0x17)) {
        lit = val.mNext.toString(16);
        reg = Disasm.REG_DISASM[enc - 0x10];
        return v = "[0x" + lit + "+" + reg + "]";
      } else if (enc === 0x18) {
        return v = "POP";
      } else if (enc === 0x19) {
        return v = "PEEK";
      } else if (enc === 0x1a) {
        return v = "PUSH";
      } else if (enc === 0x1b) {
        return v = "SP";
      } else if (enc === 0x1c) {
        return v = "PC";
      } else if (enc === 0x1d) {
        return v = "O";
      } else if (enc === 0x1e) {
        lit = val.mNext.toString(16);
        return v = "[0x" + lit + "]";
      } else if (enc === 0x1f) {
        lit = val.mNext.toString(16);
        return "0x" + lit;
      } else if ((0x20 <= enc && enc <= 0x3f)) {
        lit = val.mNext.toString(16);
        return "0x" + ((enc - 0x20).toString(16));
      }
    };

    return Disasm;

  })();

  exports.Disasm = Disasm;

}).call(this);
